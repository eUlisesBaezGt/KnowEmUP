<html>
<head>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
        google.charts.load('current', {'packages': ['corechart']});
        google.charts.setOnLoadCallback(drawChart);

        function drawChart() {
            let xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function () {
                if (xhr.readyState === 4 && xhr.status === 200) {
                    let jsonData = JSON.parse(xhr.responseText);

                    console.log('JSON Data:', jsonData);

                    let data = new google.visualization.DataTable();
                    data.addColumn('string', 'Semester');
                    data.addColumn('number', 'Quantity');

                    for (let i = 0; i < jsonData.length; i++) {
                        const row = jsonData[i];
                        const count = parseInt(row.count);

                        console.log('Row:', row);
                        console.log('Parsed Count:', count);

                        data.addRow([row.semester, count]);
                    }

                    console.log('Data Table:', data);

                    let piechart_options = {
                        title: '¿De qué semestre son nuestros usuarios?',
                        width: 1000,
                        height: 1000
                    };
                    let piechart = new google.visualization.PieChart(document.getElementById('piechart_div'));
                    piechart.draw(data, piechart_options);
                }
            };
            xhr.open('GET', 'http://localhost/knowemup/test_front/index.php', true);
            xhr.send();
        }

    </script>
</head>
<body>
<div id="piechart_div" style="border: 1px solid #ccc"></div>
</body>
</html>


